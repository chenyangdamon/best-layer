!function(){function e(e){return e.replace(m,"").replace(v,",").replace(b,"").replace(g,"").replace($,"").split(w)}function t(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function n(n,r){function a(e){return h+=e.split(/\n/).length-1,u&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=b[1]+t(e)+b[2]+"\n"),e}function o(t){var n=h;if(c?t=c(t,r):i&&(t=t.replace(/\n/g,function(){return"$line="+ ++h+";"})),0===t.indexOf("=")){var a=d&&!/^=[=#]/.test(t);if(t=t.replace(/^=[=#]?|[\s;]*$/g,""),a){var o=t.replace(/\s*\([^\)]+\)/,"");p[o]||/^(include|print)$/.test(o)||(t="$escape("+t+")")}else t="$string("+t+")";t=b[1]+t+b[2]}return i&&(t="$line="+n+";"+t),y(e(t),function(e){if(e&&!m[e]){var t;t="print"===e?$:"include"===e?w:p[e]?"$utils."+e:f[e]?"$helpers."+e:"$data."+e,x+=e+"="+t+",",m[e]=!0}}),t+"\n"}var i=r.debug,l=r.openTag,s=r.closeTag,c=r.parser,u=r.compress,d=r.escape,h=1,m={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},v="".trim,b=v?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],g=v?"$out+=text;return $out;":"$out.push(text);",$="function(){var text=''.concat.apply('',arguments);"+g+"}",w="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+g+"}",x="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(i?"$line=0,":""),k=b[0],_="return new String("+b[3]+");";y(n.split(l),function(e){var t=(e=e.split(s))[0],n=e[1];1===e.length?k+=a(t):(k+=o(t),n&&(k+=a(n)))});var j=x+k+_;i&&(j="try{"+j+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+t(n)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var T=new Function("$data","$filename",j);return T.prototype=p,T}catch(e){throw e.temp="function anonymous($data,$filename) {"+j+"}",e}}var r=function(e,t){return"string"==typeof t?h(t,{filename:e}):i(e,t)};r.version="3.0.0",r.config=function(e,t){a[e]=t};var a=r.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},o=r.cache={};r.render=function(e,t){return h(e,t)};var i=r.renderFile=function(e,t){var n=r.get(e)||d({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n};r.get=function(e){var t;if(o[e])t=o[e];else if("object"==typeof document){var n=document.getElementById(e);if(n){var r=(n.value||n.innerHTML).replace(/^\s*|\s*$/g,"");t=h(r,{filename:e})}}return t};var l=function(e,t){return"string"!=typeof e&&("number"==(t=typeof e)?e+="":e="function"===t?l(e.call(e)):""),e},s={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},c=function(e){return s[e]},u=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=r.utils={$helpers:{},$include:i,$string:l,$escape:function(e){return l(e).replace(/&(?![\w#]+;)|[<>"']/g,c)},$each:function(e,t){var n,r;if(u(e))for(n=0,r=e.length;r>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)}};r.helper=function(e,t){f[e]=t};var f=r.helpers=p.$helpers;r.onerror=function(e){var t="Template Error\n\n";for(var n in e)t+="<"+n+">\n"+e[n]+"\n\n";"object"==typeof console&&console.error(t)};var d=function(e){return r.onerror(e),function(){return"{Template Error}"}},h=r.compile=function(e,t){function r(n){try{return new s(n,l)+""}catch(r){return t.debug?d(r)():(t.debug=!0,h(e,t)(n))}}t=t||{};for(var i in a)void 0===t[i]&&(t[i]=a[i]);var l=t.filename;try{var s=n(e,t)}catch(e){return e.filename=l||"anonymous",e.name="Syntax Error",d(e)}return r.prototype=s.prototype,r.toString=function(){return s.toString()},l&&t.cache&&(o[l]=r),r},y=p.$each,m=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,v=/[^\w$]+/g,b=new RegExp(["\\b"+"break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined".replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),g=/^\d[^,]*|,\d[^,]*/g,$=/^,+|,+$/g,w=/^$|,+/;a.openTag="{{",a.closeTag="}}";var x=function(e,t){var n=t.split(":"),r=n.shift(),a=n.join(":")||"";return a&&(a=", "+a),"$helpers."+r+"("+e+a+")"};a.parser=function(e){var t=(e=e.replace(/^\s/,"")).split(" "),n=t.shift(),a=t.join(" ");switch(n){case"if":e="if("+a+"){";break;case"else":e="}else"+(t="if"===t.shift()?" if("+t.join(" ")+")":"")+"{";break;case"/if":e="}";break;case"each":var o=t[0]||"$data",i=t[1]||"as",l=t[2]||"$value",s=t[3]||"$index";"as"!==i&&(o="[]"),e="$each("+o+",function("+(l+","+s)+"){";break;case"/each":e="});";break;case"echo":e="print("+a+");";break;case"print":case"include":e=n+"("+t.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(a)){var c=!0;0===e.indexOf("#")&&(e=e.substr(1),c=!1);for(var u=0,p=e.split("|"),f=p.length,d=p[u++];f>u;u++)d=x(d,p[u]);e=(c?"=":"=#")+d}else e=r.helpers[n]?"=#"+n+"("+t.join(",")+");":"="+e}return e},"function"==typeof define?define(function(){return r}):"undefined"!=typeof exports?module.exports=r:this.template=r}(),function(e,t){"function"==typeof define&&define.amd?define(["jquery","template"],function(){t.apply(e,arguments)}):t.call(e,e.$,template)}(window,function(e,t){var n=function(){this.defaultOption={title:"通知",skin:"",header:!0,overlayer:!0,swapping:!1,draggable:!1,data:null,url:"",buttons:[],animation:["zoomIn","zoomOut"]},this.init.apply(this,arguments)};n.prototype={constructor:"Layer",init:function(){var e=this;e.layers=[],e.noop=function(){console.log("The layer's closed. You didn't do anything...")}},_bindEvent:function(){var t=this;e("body").on("click",".best-layer-close",function(){var n=e(this).closest(".best-layer").data("layerid");n&&t.close(n)}),e("body").on("click",".best-layer-button",function(){var n=e(this).index(),r=e(this).closest(".best-layer").data("layerid"),a=t.option.buttons[n],o=a&&a.handler||t.noop;a&&!1!==o.call(t)&&t.close(r)}),e("body").on("click",".best-layer-overlayer",function(){var n=t.option.swapping;"boolean"==typeof n&&n&&t.close(e(this).closest(".best-layer").data("layerid"))}),e(window).resize(function(){if(!t.option.draggable)for(var e=t.layers,n=0,r=e.length;n<r;n++)t._setpos(e[n].find(".best-layer-core"))})},open:function(){var t=this;t.option=e.extend({},t.defaultOption,arguments[0]),t._bindEvent(),e.get(t.option.url,function(e){e&&(t.tpl=e,t._render())})},close:function(e){for(var t=this,n=null,r=0,a=t.layers.length;r<a;r++){if(n=t.layers[r],_layerid=n.data("layerid"),_layerid===e){n.find(".best-layer-core").toggleClass(t.toggleAnimation),n.find(".best-layer-overlayer").animate({opacity:0},290);var o=setTimeout(function(){n.remove(),clearTimeout(o)},290);t.layers.splice(r,1)}t.layerid===e&&delete t.layerid}},_render:function(){var t=this,n=t._assemble();if(n.length){var r=n.find(".best-layer-core");e("body").append(n),t.option.draggable&&t._drag(r),t._setpos(r),t.layers.push(n)}},_assemble:function(){var t=this,n=[],r=t._compile();if(t.layerid=+new Date,r)return t.toggleAnimation=t.option.animation.join(" "),(n=["<div class='best-layer "+t.option.skin+"' data-layerid="+t.layerid+">\x3c!-- 弹层核心 --\x3e<div class='best-layer-core animation "+t.option.animation[0]+"'>"]).push(t.option.header?"\x3c!-- 弹层header --\x3e<div class='best-layer-core-header'><div class='best-layer-core-header-title'>"+t.option.title+"</div><div class='best-layer-core-header-close best-layer-close'></div></div>":""),n.push("\x3c!-- 弹层body --\x3e<div class='best-layer-core-body'>"+r+"</div>"),n.push("\x3c!-- 弹层footer --\x3e<div class='best-layer-core-footer'>"+t._drawbutton()+"</div>"),n.push("</div>\x3c!-- / End 弹层核心 --\x3e"+(t.option.overlayer?"\x3c!--遮罩层--\x3e<div class='best-layer-overlayer'></div>\x3c!-- / End 遮罩层 --\x3e":"")+"</div>"),e(n.join(""))},_compile:function(){var n=this,r=n.tpl,a=n.option.data;return e.trim(r)?t.compile(r)(a||""):""},_drawbutton:function(){for(var e=this.option.buttons,t=[],n=0,r=e.length;n<r;n++)t.push("<a href='javascript:;' class='best-layer-button button "+e[n].skin+"'>"+e[n].text+"</a>");return t.join("")},_setpos:function(t){var n=(e(window).outerWidth()-t.outerWidth())/2,r=(e(window).outerHeight()-t.outerHeight())/2;t.css({left:n,top:r})},_drag:function(t){var n=this;t instanceof jQuery&&t.mousedown(function(t){var r=e(this),a=t.pageX-r.offset().left,o=t.pageY-r.offset().top,i=e(window).outerWidth()-r.outerWidth(),l=e(window).outerHeight()-r.outerHeight();return e(document).mousemove(function(e){var t=e.pageX-a,s=e.pageY-o;t=n._range(i,0,t),s=n._range(l,0,s),r.css({left:t,top:s})}),e(document).mouseup(function(){e(this).off()}),!1})},_range:function(e,t,n){return n<t?t:n>e?e:n}},n.alert=function(e){(new n).open({title:e.title,skin:e.skin||"best-layer-alert",data:e.data,url:"/template/alert.tpl.html",buttons:[{text:"确 定",skin:"button-primary button-h-30",handler:e.confirm}]})},n.confirm=function(e){(new n).open({title:e.title,skin:e.skin||"best-layer-confirm",data:e.data,url:"/template/confirm.tpl.html",buttons:[{text:"确 定",skin:"button-primary button-h-30",handler:e.confirm},{text:"取 消",skin:"button-primary button-h-30 button-outline",handler:e.cancel}]})},n.prompt=function(e){(new n).open({title:e.title,skin:e.skin||"best-layer-prompt",data:e.data,url:"/template/prompt.tpl.html",buttons:[{text:"确 定",skin:"button-primary button-h-30",handler:e.confirm},{text:"取 消",skin:"button-primary button-h-30 button-outline",handler:e.cancel}]})},this.Layer=n});